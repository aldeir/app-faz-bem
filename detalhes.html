<!DOCTYPE html>
<html lang="pt-BR">
<head>
    </head>
<body class="bg-gray-50">

    <div id="loading-container" class="flex items-center justify-center h-screen">
        </div>

    <main id="campaign-content" class="hidden container mx-auto max-w-5xl p-4 sm:p-6 my-8">
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
            <div class="grid grid-cols-1 lg:grid-cols-5">
                <div class="lg:col-span-3 p-6">
                    <div id="media-gallery" class="mb-6">
                        <div class="w-full h-96 bg-black rounded-xl shadow-md mb-4 flex items-center justify-center">
                            <img id="main-image" src="https://placehold.co/800x600/e2e8f0/e2e8f0" class="w-full h-full object-cover rounded-xl" alt="Imagem principal">
                            <video id="main-video" class="hidden w-full h-full rounded-xl" controls></video>
                        </div>
                        <div id="thumbnail-container" class="flex space-x-2 overflow-x-auto p-1">
                            </div>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Sobre a Campanha</h2>
                    <p id="campaign-description" class="text-gray-600 leading-relaxed"></p>
                </div>
                <div class="lg:col-span-2 bg-gray-50 p-6">
                    </div>
            </div>
        </div>
    </main>

    <script type="module">
        import { db, auth, onAuthStateChanged } from './app-config.js';
        import { doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // ... constantes do DOM ...
        
        // ... onAuthStateChanged ...

        async function loadCampaignDetails() {
            // ... busca dos dados da campanha ...

            try {
                // ...
                if (docSnap.exists()) {
                    const campaign = docSnap.data();
                    
                    // LÓGICA DA GALERIA DE MÍDIA ATUALIZADA
                    const mainImage = document.getElementById('main-image');
                    const mainVideo = document.getElementById('main-video');
                    const thumbContainer = document.getElementById('thumbnail-container');
                    thumbContainer.innerHTML = '';

                    const showImage = (url) => {
                        mainVideo.classList.add('hidden');
                        mainVideo.pause();
                        mainImage.classList.remove('hidden');
                        mainImage.src = url;
                    };

                    const showVideo = (url) => {
                        mainImage.classList.add('hidden');
                        mainVideo.classList.remove('hidden');
                        mainVideo.src = url;
                    };

                    // Adiciona thumbnail do vídeo, se existir
                    if (campaign.videoUrl) {
                        const thumb = document.createElement('div');
                        thumb.className = 'w-20 h-16 object-cover rounded-md cursor-pointer border-2 border-transparent hover:border-blue-500 flex-shrink-0 bg-black flex items-center justify-center';
                        // Ícone de play para indicar que é um vídeo
                        thumb.innerHTML = `<svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>`;
                        thumb.onclick = () => showVideo(campaign.videoUrl);
                        thumbContainer.appendChild(thumb);
                    }

                    // Adiciona thumbnails das imagens
                    (campaign.images || []).forEach(imgUrl => {
                        const thumb = document.createElement('img');
                        thumb.src = imgUrl;
                        thumb.className = 'w-20 h-16 object-cover rounded-md cursor-pointer border-2 border-transparent hover:border-green-500 flex-shrink-0';
                        thumb.onclick = () => showImage(imgUrl);
                        thumbContainer.appendChild(thumb);
                    });

                    // Define o item principal a ser exibido primeiro
                    if (campaign.videoUrl) {
                        showVideo(campaign.videoUrl);
                    } else if (campaign.images && campaign.images.length > 0) {
                        showImage(campaign.images[0]);
                    } else {
                        showImage('https://placehold.co/800x600/e2e8f0/e2e8f0?text=Sem+Mídia');
                    }

                    // ... resto da lógica para preencher título, descrição, etc ...
                } // ...
            } // ... catch ...
        }
    </script>
</body>
</html>
